<!DOCTYPE html>
<html lang="nl">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>ShiftStart – Start</title>
  
  <style>
    :root{--red:#a31212;--black:#0b0b0f;--panel:rgba(21,25,34,.86);--line:#2a2f3a;--text:#eef2f8;--muted:#9fb0cb}
    *{box-sizing:border-box} html,body{height:100%}
    body{margin:0;background:linear-gradient(90deg,var(--black) 50%,var(--red) 50%);
         color:var(--text);font-family:system-ui,-apple-system,Segoe UI,Roboto,Helvetica,Arial}
    .wrap{max-width:980px;margin:0 auto;padding:28px 18px 40px}
    .card{background:var(--panel);border:1px solid var(--line);border-radius:16px;padding:20px;backdrop-filter:blur(6px)}
    header.panel{display:flex;justify-content:space-between;align-items:center;gap:12px;flex-wrap:wrap;
                 padding:14px 16px;margin-bottom:12px;background:var(--panel);border:1px solid var(--line);border-radius:14px}
    .brand{display:flex;flex-direction:column;gap:2px}.brand .h{font-weight:800;font-size:18px}.brand .s{color:var(--muted);font-size:12px}
    .tools{display:flex;gap:8px;flex-wrap:wrap}
    button{background:#101624;color:var(--text);border:1px solid var(--line);border-radius:10px;padding:10px 12px;cursor:pointer;font-weight:600}
    .add{display:grid;grid-template-columns:1fr 1fr auto;gap:10px;margin:8px 0 4px}
    input[type="text"]{width:100%;padding:12px 14px;border-radius:10px;border:1px solid var(--line);background:#0b0f18;color:var(--text)}
    ul{list-style:none;padding:0;margin:0;display:flex;flex-direction:column;gap:8px}
    li.item{display:flex;align-items:center;gap:12px;background:#0f1320;border:1px solid #262c39;border-radius:12px;padding:12px 14px}
    a.label{flex:1;color:inherit;text-decoration:none}
    .trash{display:inline-flex;align-items:center;justify-content:center;width:28px;height:28px;border:1px solid #444;border-radius:6px;background:#151a23}
    li.item.dragging{opacity:.6;outline:1px dashed #6aa0ff}
    .hint{color:var(--muted);font-size:12px;margin:6px 2px 0}
    footer.note{margin-top:12px;color:var(--muted);font-size:12px;text-align:center}
  </style>
</head>
<body>
  <div class="wrap">
    <header class="panel card">
      <div class="brand">
        <div class="h">ShiftStart</div>
        <div class="s">Startpagina</div>
      </div>
      <div class="tools"></div>
    </header>

    <div class="card">
      <div class="add">
        <input id="newTitle" type="text" placeholder="Knopnaam (bv. Prioriteit)" />
        <input id="newHref"  type="text" placeholder="Link (bv. prioriteit.html)" />
        <button id="btnAdd">Toevoegen</button>
      </div>
      <ul id="pages"></ul>
      <p class="hint">🔒 Zonder inloggen kun je alleen openen. Na inloggen kun je toevoegen, verwijderen en slepen.</p>
    </div>

    <footer class="note">ShiftStart · gedeelde opslag via Firebase</footer>
  </div>

 <script type="module">
   alert("JS module draait ✅");
/* ==== IMPORTS ==== */
import { initializeApp } from "https://www.gstatic.com/firebasejs/10.14.0/firebase-app.js";
import { getFirestore, doc, getDoc, setDoc, serverTimestamp } from "https://www.gstatic.com/firebasejs/10.14.0/firebase-firestore.js";
import { firebaseConfig } from "./firebase-config.js?v=15";

/* ==== FIREBASE ==== */
const app = initializeApp(firebaseConfig);
const db  = getFirestore(app);
const HOME_ID = "home";

/* ==== UI HOOKS (maakt wat ontbreekt zelf aan) ==== */
const addBar   = document.querySelector(".card .add") || document.querySelector(".card"); // jouw invoervak + knop
let   elTitle  = document.querySelector('input[placeholder^="Knopnaam"]');
let   elHref   = document.querySelector('input[placeholder^="Link"]');
let   btnAdd   = document.getElementById("btnAdd") || document.querySelector('.card .add button');

if (!elTitle) { elTitle = document.createElement("input"); elTitle.placeholder = "Knopnaam (bv. Prioriteit)"; elTitle.style.marginRight = "8px"; addBar?.prepend(elTitle); }
if (!elHref)  { elHref  = document.createElement("input"); elHref.placeholder  = "Link (bv. prioriteit.html)"; addBar?.appendChild(elHref); }
if (!btnAdd)  { btnAdd  = document.createElement("button"); btnAdd.id="btnAdd"; btnAdd.textContent="Toevoegen"; addBar?.appendChild(btnAdd); }

let list = document.getElementById("list");
if (!list) { list = document.createElement("ul"); list.id = "list"; list.style.listStyle = "none"; list.style.padding = "0"; list.style.marginTop="10px"; addBar?.parentElement?.appendChild(list); }

/* tools (slot-knoppen) rechtsboven in de header */
let tools = document.querySelector("header .tools");
if (!tools) {
  tools = document.createElement("div");
  tools.className = "tools";
  tools.style.display="flex"; tools.style.gap="8px";
  document.querySelector("header.panel")?.appendChild(tools);
}
const btnEdit = document.createElement("button"); btnEdit.textContent = "🔓 Bewerk-modus";
const btnView = document.createElement("button"); btnView.textContent = "🔒 Alleen openen";
tools.replaceChildren(btnEdit, btnView);

/* ==== STATE ==== */
let canEdit = (localStorage.getItem("editMode") === "1");
let pages = []; // [{t:'Titel', h:'link.html'}, ...]

/* ==== HELPERS ==== */
const save = (payload) =>
  setDoc(doc(db,"lists",HOME_ID), { pages: payload, updatedAt: serverTimestamp() }, { merge:true });

const load = async () => {
  const snap = await getDoc(doc(db,"lists",HOME_ID));
  if (snap.exists()) {
    const d = snap.data();
    pages = Array.isArray(d.pages) ? d.pages : [];
  } else {
    pages = [];
    await save(pages);
  }
};

function updateUI(){
  [elTitle, elHref, btnAdd].forEach(el=>{
    if(!el) return;
    el.disabled = !canEdit;
    el.style.opacity = canEdit ? 1 : 0.6;
    el.style.pointerEvents = canEdit ? "auto" : "none";
  });
  // toon prullenbakjes (CSS via inline, geen extra <style> nodig)
  [...list.querySelectorAll(".trash")].forEach(b=> b.style.display = canEdit ? "inline-flex" : "none");
}

function render(){
  list.innerHTML = "";
  pages.forEach((p, idx)=>{
    const li = document.createElement("li");
    li.style.display="flex"; li.style.alignItems="center"; li.style.gap="10px";
    li.style.padding="12px"; li.style.border="1px solid #262c39"; li.style.borderRadius="10px";
    li.style.background="#0f1320"; li.dataset.index = String(idx);

    const a  = document.createElement("a");
    a.href = p.h || "#"; a.textContent = p.t || "(zonder naam)";
    a.className = "label"; a.style.flex = "1"; a.style.color = "#d8e6ff"; a.style.textDecoration="none";

    const trash = document.createElement("button");
    trash.className="trash";
    trash.title="Verwijderen"; trash.textContent="🗑️";
    Object.assign(trash.style, {display: canEdit ? "inline-flex" : "none", alignItems:"center", justifyContent:"center",
      width:"28px", height:"28px", border:"1px solid #444", borderRadius:"6px", background:"#151a23", cursor:"pointer", opacity:"0.9"});
    trash.onclick = () => removeItem(p.t);

    if (canEdit) {
      li.draggable = true;
      li.addEventListener("dragstart", e => { li.style.opacity=".6"; e.dataTransfer.setData("text/plain", String(idx)); });
      li.addEventListener("dragend",   () => { li.style.opacity="1"; });
      li.addEventListener("dragover",  e => e.preventDefault());
      li.addEventListener("drop", e => {
        e.preventDefault();
        const from = Number(e.dataTransfer.getData("text/plain"));
        const to   = Number(li.dataset.index);
        if (Number.isFinite(from) && Number.isFinite(to) && from!==to) {
          const next = pages.slice();
          const [m] = next.splice(from,1);
          next.splice(to,0,m);
          pages = next; render(); save(pages);
        }
      });
    }

    li.append(a, trash);
    list.appendChild(li);
  });
  updateUI();
}

/* ==== ACTIES ==== */
async function addPage(){
  const t = (elTitle.value||"").trim();
  const h = (elHref.value||"").trim();
  if (!t || !h) return;
  if (pages.some(p => p.t === t)) { alert("Naam bestaat al."); return; }
  pages = pages.concat({ t, h });
  await save(pages);
  elTitle.value = ""; elHref.value = ""; elTitle.focus();
  render();
}

async function removeItem(title){
  if (!canEdit) return;
  const ok = confirm(`Weet je zeker dat je "${title}" wilt verwijderen?`);
  if (!ok) return;
  pages = (pages||[]).filter(p => (p.t !== title));
  await save(pages);
  render();
}

/* ==== EVENTS ==== */
btnAdd?.addEventListener("click", addPage);
elTitle?.addEventListener("keydown", e=>{ if(e.key==="Enter"){ e.preventDefault(); addPage(); }});
elHref ?.addEventListener("keydown", e=>{ if(e.key==="Enter"){ e.preventDefault(); addPage(); }});

btnEdit.onclick = () => { canEdit = true;  localStorage.setItem("editMode","1"); updateUI(); render(); };
btnView.onclick = () => { canEdit = false; localStorage.removeItem("editMode"); updateUI(); render(); };

/* ==== START ==== */
try { await load(); render(); updateUI(); }
catch(e){ console.error(e); alert("Kon startpagina niet laden. Zie Console voor details."); }
</script>
</body>
</html>
