<!DOCTYPE html>
<html lang="nl">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>ShiftStart ‚Äì Schoonmaakklussen</title>
  <link rel="icon" href="data:,">
  <style>
    :root {
      --red:#a31212; --black:#0b0b0f; --panel:rgba(21,25,34,.86);
      --line:#2a2f3a; --text:#eef2f8; --muted:#9fb0cb;
    }
    *{box-sizing:border-box} html,body{height:100%}
    body{
      margin:0;
      background:linear-gradient(90deg,var(--black) 50%,var(--red) 50%);
      color:var(--text);
      font-family:system-ui,-apple-system,Segoe UI,Roboto,Helvetica,Arial;
    }
    .wrap{max-width:980px;margin:0 auto;padding:28px 18px 40px}
    .card{background:var(--panel);border:1px solid var(--line);border-radius:16px;padding:20px;backdrop-filter:blur(6px)}
    header.panel{display:flex;justify-content:space-between;align-items:center;gap:12px;flex-wrap:wrap;padding:14px 16px;margin-bottom:12px;background:var(--panel);border:1px solid var(--line);border-radius:14px}
    .brand .h{font-weight:800;font-size:18px}.brand .s{color:var(--muted);font-size:12px}
    button{background:#101624;color:var(--text);border:1px solid var(--line);border-radius:10px;padding:10px 12px;cursor:pointer;font-weight:600}
    .tools{display:none;gap:8px;flex-wrap:wrap}
    .add{display:grid;grid-template-columns:1fr auto;gap:10px;margin:8px 0 4px}
    input[type="text"]{width:100%;padding:12px 14px;border-radius:10px;border:1px solid var(--line);background:#0b0f18;color:var(--text)}
    ul{list-style:none;padding:0;margin:0;display:flex;flex-direction:column;gap:8px}
    li.item{display:flex;align-items:center;gap:8px;background:#0f1320;border:1px solid #262c39;border-radius:12px;padding:12px 14px}
    li.item.done{opacity:.6;text-decoration:line-through}
    .label{flex:1;cursor:pointer}
    .btn{display:inline-flex;align-items:center;justify-content:center;width:28px;height:28px;border:1px solid #444;border-radius:6px;background:#151a23;cursor:pointer;opacity:.95}
    .nav{display:flex;gap:10px;margin-bottom:12px}.nav a{color:#d8e6ff}
    .divider{height:1px;background:#2a2f3a;margin:12px 0;border-radius:1px}
    .section-head{font-weight:800;opacity:.95;margin:6px 0 8px;text-transform:uppercase;letter-spacing:.5px;color:#fff}
  </style>
</head>
<body>
  <div class="wrap">
    <nav class="nav"><a href="index.html">‚Üê Terug</a></nav>

    <header class="panel card">
      <div class="brand">
        <div class="h">ShiftStart</div>
        <div class="s">Schoonmaakklussen</div>
      </div>
      <div class="header-right">
        <button id="btnBackoffice">Back Office</button>
        <div class="tools"></div>
      </div>
    </header>

    <div class="card" id="card-root">
      <div class="add">
        <input id="newItem" type="text" placeholder="Nieuw item toevoegen..." />
        <button id="btnAdd">Toevoegen</button>
      </div>

      <section id="sec-fast">
        <div class="section-head">SNELLE TAKEN</div>
        <ul id="list-fast"></ul>
      </section>

      <div class="divider"></div>

      <section id="sec-big">
        <div class="section-head">GROTE SCHOONMAAKKLUSSEN</div>
        <ul id="list-big"></ul>
      </section>
    </div>

    <footer class="note">ShiftStart ¬∑ gedeelde opslag via Firebase</footer>
  </div>

<script type="module">
import { initializeApp } from "https://www.gstatic.com/firebasejs/10.14.0/firebase-app.js";
import { getFirestore, doc, onSnapshot, setDoc, serverTimestamp, updateDoc, deleteField } from "https://www.gstatic.com/firebasejs/10.14.0/firebase-firestore.js";
import { firebaseConfig } from "./firebase-config.js?v=15";

const app = initializeApp(firebaseConfig);
const db  = getFirestore(app);

const DOC_ID = "schoonmaak_klussen";
const ADMIN_CODE = "Yali313";
const LS_EDIT = "editMode";
const LS_BACK = "backoffice_unlocked";

/* UI refs */
const toolsBar = document.querySelector(".tools");
const btnBackoffice = document.getElementById("btnBackoffice");
const elNew = document.getElementById("newItem");
const btnAdd = document.getElementById("btnAdd");
const ulFast = document.getElementById("list-fast");
const ulBig = document.getElementById("list-big");

/* Tools */
const btnEdit = document.createElement("button");
btnEdit.textContent = "üîì Bewerk-modus";
const btnView = document.createElement("button");
btnView.textContent = "üîí Alleen afvinken";
const btnReset = document.createElement("button");
btnReset.textContent = "üîÅ Resetten";
const btnPrio1 = document.createElement("button");
btnPrio1.textContent = "Prioriteit 1";
const btnPrio2 = document.createElement("button");
btnPrio2.textContent = "Prioriteit 2";
toolsBar.replaceChildren(btnEdit, btnView, btnReset, btnPrio1, btnPrio2);

/* State */
let canEdit = localStorage.getItem(LS_EDIT)==="1";
let backUnlocked = localStorage.getItem(LS_BACK)==="1";
let items = {};
let order = [];

/* ===== Firebase sync ===== */
onSnapshot(doc(db,"lists",DOC_ID), async snap=>{
  if(snap.exists()){
    const d = snap.data();
    items = d.items || {};
    order = d.order || Object.keys(items);
  } else {
    const s = getSeed();
    items = s.items; order = s.order;
    await setDoc(doc(db,"lists",DOC_ID), { items, order });
  }
  render();
});

/* ===== Data seed ===== */
function getSeed(){
  const items = {
    "Dresstafel volledig schoonmaken, onder de kratten en mandjes": false,
    "Counterblad schoonmaken en desinfecteren (inclusief schermen)": false,
    "Tafeltje bij shake apparaat schoonmaken en daarna met RVS": false,
    "Bin aan de bovenkant schoonmaken": false,
    "Vriezer aan de voorkant schoonmaken met blauwe spons en blauwe spray": false,
    "Bovenkant milkshake & ijs apparaat afspoelen en afdrogen": false,
    "Bezorgtafel schoonmaken en de tassen legen": false,
    "Fietsbakken legen van de bonnen en schoonmaken": false,
    "Vriezers in opslag met een doekje schoonmaken": false,
    "Opslag & counter bij de shake apparaat vegen en dweilen": false,
    "Deurposten schoonmaken met blauwe spons en blauwe spray": false,
    "Bubble tea shaker/sealer schoonmaken":false,
    "Voorkant en de bovenkant van de bubble tea koeling schoonamekn":false,
    "De shakers(bekers) gronding schoonmaken met spons en water":false,
    "Vriezers in opslag schoonmaken": false,
    "Vriezers in opslag naar voren en erachter schoonmaken": false,
    "Rubbers van de vriezers/koelkast in opslag schoonmaken en de binnenkant stofzuigen": false,
    "Koelkast Keuken/Opslag volledig schoonmaken inclusief het glas": false,
    "Side vriezers schoonmaken/ijskrabben": false,
    "Sink volledig schoonmaken en onder vegen en dweilen": false,
    "Achter bij de stellingen vegen en dweilen (ook onder de stellingen)": false,
    "Bezorgtafel schoonmaken en daarachter vegen en dweilen (let op kabels!)": false,
    "Onderdelen van de bin schoonmaken en de binnenkant stofzuigen": false,
    "Achter apparatuur schoonmaken inclusief de muren": false,
    "Apparatuur schoonmaken, zij/voor/achterkant": false,
    "Afzuigroosters schoonmaken": false,
    "Stoffer en blik, wassen en drogen": false,
    "Prullenbak schoonmaken en drogen": false,
    "Dranken koelkat volledig schoonmaken met blauwe spons en een doek": false,
    "Broodkar schoonmaken inclusief de kratten": false,
    "WC schoonmaken": false
  };
  return { items, order:Object.keys(items) };
}

/* ===== Render ===== */
function render(){
  ulFast.innerHTML=""; ulBig.innerHTML="";
  order.forEach(k=>{
    const li=document.createElement("li");
    li.className="item"+(items[k]?" done":"");
    const cb=document.createElement("input");
    cb.type="checkbox"; cb.checked=!!items[k];
    cb.onchange=()=>toggle(k);
    const label=document.createElement("div");
    label.className="label"; label.textContent=k;
    if(!canEdit) label.onclick=()=>toggle(k);
    li.append(cb,label);
    (k.includes("Dresstafel")||k.includes("Counterblad")||k.includes("Shake")||k.includes("Bin")||k.includes("Bezorgtafel")||k.includes("Vriezer aan de voorkant") ? ulFast : ulBig).appendChild(li);
  });
}

/* ===== Toggle ===== */
function toggle(k){
  items[k]=!items[k];
  setDoc(doc(db,"lists",DOC_ID),{items},{merge:true});
}

/* ===== Reset knop ===== */
btnReset.onclick=()=>{ Object.keys(items).forEach(k=>items[k]=false); setDoc(doc(db,"lists",DOC_ID),{items},{merge:true}); render(); };

/* ===== Prioriteitknoppen ===== */
btnPrio1.onclick=()=>{document.getElementById("sec-big").style.display="block";document.getElementById("sec-fast").style.display="none";}
btnPrio2.onclick=()=>{document.getElementById("sec-big").style.display="none";document.getElementById("sec-fast").style.display="block";}

/* ===== Back Office popup met sterretjes ===== */
btnBackoffice.onclick=()=>{
  const modal=document.createElement("div");
  Object.assign(modal.style,{position:"fixed",inset:"0",background:"rgba(0,0,0,0.6)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:"9999"});
  const box=document.createElement("div");
  Object.assign(box.style,{background:"#141824",padding:"20px",borderRadius:"12px",textAlign:"center",width:"260px"});
  const label=document.createElement("div");label.textContent="Voer beheerderscode in:";label.style.marginBottom="10px";
  const input=document.createElement("input");input.type="password";input.placeholder="‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢";Object.assign(input.style,{width:"100%",padding:"10px",borderRadius:"8px",border:"1px solid #333",background:"#0b0f18",color:"#fff",marginBottom:"12px"});
  const ok=document.createElement("button");ok.textContent="Ontgrendel";Object.assign(ok.style,{background:"#1c2333",color:"#fff",border:"1px solid #444",borderRadius:"8px",padding:"8px 14px",cursor:"pointer"});
  const cancel=document.createElement("button");cancel.textContent="Annuleren";Object.assign(cancel.style,{marginLeft:"8px",background:"#333",color:"#ccc",border:"1px solid #555",borderRadius:"8px",padding:"8px 14px",cursor:"pointer"});
  box.append(label,input,ok,cancel);modal.append(box);document.body.append(modal);input.focus();
  ok.onclick=()=>{if(input.value.trim()===ADMIN_CODE){backUnlocked=true;canEdit=true;localStorage.setItem(LS_BACK,"1");localStorage.setItem(LS_EDIT,"1");toolsBar.style.display="flex";modal.remove();alert("Back Office geopend ‚úÖ");render();}else{alert("Onjuiste code");input.value="";input.focus();}}
  cancel.onclick=()=>modal.remove();
};

/* ===== Bewerk/alleen-afvinken ===== */
btnEdit.onclick=()=>{canEdit=true;localStorage.setItem(LS_EDIT,"1");render();alert("Bewerk-modus aan ‚úÖ");}
btnView.onclick=()=>{canEdit=false;localStorage.removeItem(LS_EDIT);render();alert("Alleen afvinken üîí");}

/* ===== Init ===== */
if(backUnlocked) toolsBar.style.display="flex";
</script>
</body>
</html>
